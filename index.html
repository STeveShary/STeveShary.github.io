<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Thoughts on development, code, and dev culture. &#8211; STeve Smash Code</title>
<meta name="description" content="A blog on development, code and dev culture.">
<meta name="keywords" content="Java, Javascript, Clojure, JVM, code, development culture, devops">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Thoughts on development, code, and dev culture.">
<meta property="og:description" content="A blog on development, code and dev culture.">
<meta property="og:url" content="/">
<meta property="og:site_name" content="STeve Smash Code">





<link rel="canonical" href="/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="STeve Smash Code Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="/assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="entry-header">
  <div class="header-menu header-menu-top header-menu-overflow">
    <ul>
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="/">
          
          <h2 class="title"> STeve Smash Code</h2>
        </a>
      </li>
      
        
        

        
          <li class="header-item "><a href="/about"><h3>About</h3></a></li>
        
      
      <li class="header-item  "><a href="/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="/about"><h3>About</h3></a></li>
      
    
  </ul>
</nav>




<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-01-03T00:00:00-05:00"><a href="/testing/end-to-end-testing-problem/">January 03, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Stephen Shary">Stephen Shary</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~4 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/testing/end-to-end-testing-problem/" rel="bookmark" title="The Solution to the Temptation of End-To-End Tests: Integration Testing" itemprop="url">The Solution to the Temptation of End-To-End Tests: Integration Testing</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>The moment that you QA group figures out how to write end-to-end tests or the moment that you boss watches a selenium test, a new fever hits your team to write a test as solution to every problem.  Button the wrong color?  Write a test.  Customer got a 404?  Write a test.  Need to support IE 8?  Write a test.</p>

<p>Next thing you know your team has hundreds of tests that do bunches of things.  You also need a small super-computer cluster to run them as well.</p>

<p>The problem is that these end-to-end tests have serious inherent problems. Those problems are stablity and speed.</p>

<p>Luckily, there is a solution.  Let’s define the two problems first.</p>

<h2 id="lack-of-test-stability-is-a-loss-of-test-confidence">Lack of Test Stability is a Loss of Test Confidence</h2>

<p>Let’s talk about stability first.  I have worked on a number of projects where there is an automation test suite.  We have our unit, integration, and end-to-end test tests.  We usually have a continuous integration (CI) pipeline that will execute our tests on each check in.  Things are great for the first couple of weeks.  All steps are green and then after that we move to this:</p>

<p><img src="/images/pile-up.jpg" alt="Toy Car pile-up" class="center-image" /></p>

<p>And the failed builds are painful.  Everything goes red and stop looking at the build.  Then your team doesn’t care.</p>

<p><img src="http://s2.quickmeme.com/img/cb/cbcdef26ba7abde1ff4757fec30671b923775265466a623f022efc83c2310446.jpg" alt="Roses are red, violets are red, everything is red" class="center-image" /></p>

<p>Then you start hearing these conversations:</p>

<iframe width="420" height="200" class="center-image" src="https://www.youtube.com/embed/pKTgCZyBY4E" frameborder="0" allowfullscreen=""></iframe>

<p>The thing is though is that we still care about the first tests: unit.  Why is that?  Well because they are stable.  We make git hooks that prevent people from pushing code to a broken build but our integration and end-to-end tests are still a total blood-bath.  Below is a graph the depicts the stability of tests along with team confidence.</p>

<p><img src="/images/testing-stability-graph.png" alt="Graph of Test Stability and Team Confidence along with Number of Tests" class="center-image" /></p>

<p>One thing to think about.  If your test environment works 99% of the time and you have 200+ tests, then you are statistically going to fail almost every build.  The law of averages is <em>NOT</em> on your side.  Even if you get a good build, how often will that happen?</p>

<h4 id="solutions-to-complexity">Solutions to Complexity</h4>

<p>First thought: Keep it simple.  That seems to be like a obvious solution but try to get your team to focus on integrating the peices that have the most complex interaction.  If two parts connect in one way, then how much benefit do you get putting them together.  If you have two units that interact back and forth, then integrate those together.  More is not always better.</p>

<p>Second thought: Write a stub for the flakiest part of the system.  Do you rely on that third-party processor and it works 80% of the time?   Rip out the actual interaction into a stub!  It may take a little time but it will make your tests reliable.</p>

<p>A real-world example:  I was working on a project where we have a complex front-end web application and then a complex back-end that makes calls to multiple services.  Past projects that were somewhat similar had always run into problems with the end-to-end tests where the back-end server would 500 or timeout (always randomly) and the tests would break.  So we used <a href="http://sinonjs.org/">sinon.js</a> to fake XMLHttpRequests.  You know what?  That works 100% of the time.  No weird delays, unexpected responses.  The stubbing framework was &lt; 200 lines of code and it opened us to up to write several tests on failure scenarios that are very, very difficult to recreate in a true end-to-end test.</p>

<h2 id="lack-of-test-performance--i-dont-run-those">Lack of Test Performance = “I don’t run those”</h2>

<p>Developers are impatient.  They are also easily distracted when they have to do something they don’t want to do.  So when you have tests that don’t run quickly, then people don’t run them.  One solution that I hear about the “nightly build”.  I have never worked on a team that had this, but the problem is that you delay feedback to developers.   Why!?!  I want to know as quickly as possible that I broke something.  First, I don’t want the shame of make a code change that breaks 500+ tests and then have to do the revert of shame.</p>

<p>Plus if you have the central authority run the tests, then your commit messages would look like this:</p>

<p><img src="http://imgs.xkcd.com/comics/git_commit.png" alt="xkcd comit about git commit messages" class="center-image" /></p>

<h3 id="so-how-do-you-make-your-tests-run-faster">So how do you make your tests run faster?</h3>

<p>Well, there are a couple of things that can be done:</p>

<ul>
  <li>Choose frameworks that are made to be tested.</li>
  <li>Break your large number of end-to-end tests down into integration tests.</li>
  <li>If a framework has a long setup time, re-use your setup as much as possible.</li>
  <li>Run your tests in parallel.</li>
</ul>

<h2 id="integration-testing">Integration Testing</h2>

<p>Integration tests are interesting because we put together two or more units and verify that their effect and response is correct.  An integration test may have more than one side-effect.  If you have a user creation controller and a user service, when we test user creation, we send back to the user what their user name is with the controller but we will also verify that the service persists the user details.</p>

<p>Not everything can be integrated and tested.  Look for frameworks that let you do this.  I like AngularJS with their directives and new component architecture.  I also love Spring.  You can wire up all sorts of <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/integration-testing.html">crazy configurations that let you test the interaction of beans.</a>  Databases now have <a href="http://dbunit.sourceforge.net/">DbUnit</a> and Cassandra has <a href="https://github.com/jsevellec/cassandra-unit">CassandraUnit</a>.</p>

    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-12-24T00:00:00-05:00"><a href="/developer%20setup/Gradle-Intellij-Setup/">December 24, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Stephen Shary">Stephen Shary</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~7 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/developer%20setup/Gradle-Intellij-Setup/" rel="bookmark" title="Customize Gradle to setup Intellij" itemprop="url">Customize Gradle to setup Intellij</a></h1>
    
  </header>
  <div class="entry-content">
    
      <h2 id="automating-efficiency">Automating Efficiency</h2>

<p>Setting up Intellij isn’t hard.  Getting everyone on your team to do it is another thing.  Getting it right so developers are efficient is no small matter.  The little extra integration and goodness can really let people fly.  Configured Intellij environments allow developers to get near real-time feedback on their work.  Lisa Crispin talks about this in her blog about continuous integration and farming with donkeys:</p>

<blockquote>
  <p>If we have a continuous integration process that runs our regression tests on each new version of the code, we know within a few minutes or hours whether new or updated code has broken something. When we know right away, it’s easy to fix. Problems don’t worry us, because we know we can fix them in a timely manner and move on.
Short feedback loops give us confidence. Confidence leads to enjoyment.</p>
</blockquote>

<p><a href="http://lisacrispin.com/2011/03/20/shortening-the-feedback-loop/">Source</a></p>

<p>While Lisa talks about minutes and hours, I think we should be thinking now in milliseconds and seconds for a feedback loop.</p>

<h2 id="setting-up-the-intellij-project">Setting up the Intellij Project</h2>

<p>Let’s start with the project.  Gradle has documentation <a href="https://docs.gradle.org/current/dsl/org.gradle.plugins.ide.idea.model.IdeaProject.html">here</a>.</p>

<p>Below is an example idea configuration used in my base <code class="highlighter-rouge">build.gradle</code> file in the project.  I’ll go into detail on what each of the different sections mean.</p>

<noscript><pre>400: Invalid request
</pre></noscript>
<script src="https://gist.github.com/9a2fa5246c3dfbf04943.js"> </script>

<p>Looking at lines 7 and 8, there are two basic settings that can be set: the JDK level and the version control system.  These are basic options in the <a href="https://docs.gradle.org/current/dsl/org.gradle.plugins.ide.idea.model.IdeaProject.html">idea plugin Source</a>  Being documented and pretty straight-forward, it’s not hard to understand what these do.  Let’s move the crazier part.</p>

<h4 id="setting-annotation-processing">Setting Annotation Processing</h4>

<p>Line 10 is interesting because here, we are going to modify the XML.  Intellij stores its project configuration in a .ipr file in the root project directory.  So line 10 says “let’s modify that .ipr file.”  The first block is where we find the node “CompilerConfiguration” and then modify the contents.  We have to think of in-place changes because we don’t know the original state of the ipr file.  So this block:</p>

<figure class="highlight"><pre><code class="language-groovy" data-lang="groovy">          <span class="c1">// enable 'Annotation Processors'</span>
           <span class="n">xmlFile</span><span class="o">.</span><span class="na">asNode</span><span class="o">().</span><span class="na">component</span><span class="o">.</span><span class="na">find</span> <span class="o">{</span>
               <span class="n">it</span><span class="o">.</span><span class="nd">@name</span> <span class="o">==</span> <span class="s1">'CompilerConfiguration'</span>
           <span class="o">}[</span><span class="s1">'annotationProcessing'</span><span class="o">][</span><span class="mi">0</span><span class="o">].</span><span class="na">replaceNode</span> <span class="o">{</span>
               <span class="n">annotationProcessing</span> <span class="o">{</span>
                   <span class="n">profile</span><span class="o">(</span><span class="nl">default:</span> <span class="kc">true</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'Default'</span><span class="o">,</span> <span class="nl">useClasspath:</span> <span class="s1">'true'</span><span class="o">,</span> <span class="nl">enabled:</span> <span class="kc">true</span><span class="o">)</span>
               <span class="o">}</span>
           <span class="o">}</span></code></pre></figure>

<p>will produce the XML snippet:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">version=</span><span class="s">"4"</span><span class="nt">&gt;</span>
 [...]
  <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"CompilerConfiguration"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;annotationProcessing&gt;</span>
      <span class="nt">&lt;profile</span> <span class="na">default=</span><span class="s">"true"</span> <span class="na">name=</span><span class="s">"Default"</span> <span class="na">enabled=</span><span class="s">"true"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;processorPath</span> <span class="na">useClasspath=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/profile&gt;</span>
    <span class="nt">&lt;/annotationProcessing&gt;</span>
  <span class="nt">&lt;/component&gt;</span></code></pre></figure>

<p>We put this specific change in to automatically turn on annotation processing in Intellij.  This allows the Lombok plugin to compile correctly in Intellij.  You might ask “<a href="http://jnb.ociweb.com/jnb/jnbJan2010.html">What’ lombok?</a>”, well my friend, it makes POJOs into what I think that they should be.</p>

<h4 id="setting-git-vcs-root">Setting Git VCS root</h4>

<p>Intellij made this interesting “feature” where when it knows that you are using Git, it wants to know where the root of the repository is set so it can properly track changes.  In virtually every instance, it is the annoying popup in the top left where it asks you to set the VCS root.  Then when you open the dialog, it has everything set and all you have to hit is “ok”.  Well clicking buttons is annoying.  So lines 21 to 26 do this for us.  The gradle xml changes below:</p>

<figure class="highlight"><pre><code class="language-groovy" data-lang="groovy">      <span class="c1">// setup Git root</span>
      <span class="n">xmlFile</span><span class="o">.</span><span class="na">asNode</span><span class="o">().</span><span class="na">component</span><span class="o">.</span><span class="na">find</span> <span class="o">{</span> <span class="n">it</span><span class="o">.</span><span class="nd">@name</span> <span class="o">==</span> <span class="s1">'VcsDirectoryMappings'</span> <span class="o">}.</span><span class="na">replaceNode</span> <span class="o">{</span>
          <span class="n">component</span><span class="o">(</span><span class="nl">name:</span> <span class="s1">'VcsDirectoryMappings'</span><span class="o">)</span> <span class="o">{</span>
              <span class="n">mapping</span><span class="o">(</span><span class="nl">directory:</span> <span class="s2">""</span><span class="o">,</span> <span class="nl">vcs:</span> <span class="s2">""</span><span class="o">)</span>
              <span class="n">mapping</span><span class="o">(</span><span class="nl">directory:</span> <span class="s2">"\$PROJECT_DIR\$"</span><span class="o">,</span> <span class="nl">vcs:</span> <span class="s1">'Git'</span><span class="o">)</span>
          <span class="o">}</span>
      <span class="o">}</span></code></pre></figure>

<p>will produce the XML snippet:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">version=</span><span class="s">"4"</span><span class="nt">&gt;</span>

 [...]

   <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"VcsDirectoryMappings"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;mapping</span> <span class="na">directory=</span><span class="s">"$PROJECT_DIR$"</span> <span class="na">vcs=</span><span class="s">"Git"</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/component&gt;</span></code></pre></figure>

<p>Voilla!</p>

<h2 id="setting-up-the-intellij-module">Setting up the Intellij Module</h2>

<p>In Intellij, “A module is a discrete unit of functionality that can be run, tested, and debugged independently.” <a href="http://www.jetbrains.org/intellij/sdk/docs/basics/project_structure.html">Source</a>.  Here, we are going to use the idea plugin to setup our spring inspection and Infinitest setup.</p>

<p>As before, below is the gist of the project changes.  We’ll go into details about what each line is.</p>

<noscript><pre>400: Invalid request
</pre></noscript>
<script src="https://gist.github.com/a163f485c86ff4452bf8.js"> </script>

<p>The first thing to note is that we are going to be modifying the ‘.iml’ file in the project.  This will allow us to modify which plugins will be active for the module.  The idea plugin will allow us to write to this with lines: 7.  The first thing that we do is get the “FacetManager” node.  This node allows us to set which plugins are active in the module.  Lines 10 through 17 are where we get the xml tag or build one.</p>

<p>The code below gets the facet manager node and then if it finds it, removes the web facet from it.</p>

<figure class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="c1">// Find or define the facetManager XML node.</span>
<span class="kt">def</span> <span class="n">facetManager</span> <span class="o">=</span> <span class="n">xmlFile</span><span class="o">.</span><span class="na">asNode</span><span class="o">().</span><span class="na">component</span><span class="o">.</span><span class="na">find</span> <span class="o">{</span> <span class="n">it</span><span class="o">.</span><span class="nd">@name</span> <span class="o">==</span> <span class="s1">'FacetManager'</span> <span class="o">}</span> <span class="k">as</span> <span class="n">Node</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">facetManager</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Node</span> <span class="n">webFacet</span> <span class="o">=</span> <span class="n">facetManager</span><span class="o">.</span><span class="na">facet</span><span class="o">.</span><span class="na">find</span> <span class="o">{</span> <span class="n">it</span><span class="o">.</span><span class="nd">@type</span> <span class="o">==</span> <span class="s1">'web'</span> <span class="o">}</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">webFacet</span><span class="o">)</span>
          <span class="n">facetManager</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">webFacet</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">facetManager</span> <span class="o">=</span> <span class="n">xmlFile</span><span class="o">.</span><span class="na">asNode</span><span class="o">().</span><span class="na">appendNode</span><span class="o">(</span><span class="s1">'component'</span><span class="o">,</span> <span class="o">[</span><span class="nl">name:</span> <span class="s1">'FacetManager'</span><span class="o">]);</span>
  <span class="o">}</span></code></pre></figure>

<p>Next, in line 18 we are going to build our own elements so we can attach them.  Lines 20 through 28 build the nodes for spring inpsection.  Line 29 is where we attach that as a sub-element of the “FacetManager” element.</p>

<figure class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="kt">def</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NodeBuilder</span><span class="o">()</span>

<span class="c1">// Setup Spring Wiring inspection.</span>
<span class="kt">def</span> <span class="n">springFacet</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">facet</span><span class="o">(</span><span class="nl">type:</span> <span class="s1">'Spring'</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'Spring'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">configuration</span> <span class="o">{</span>
        <span class="n">fileset</span><span class="o">(</span><span class="nl">id:</span> <span class="s1">'fileset'</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'Spring Application Context'</span><span class="o">,</span>  <span class="nl">removed:</span><span class="s1">'false'</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">file</span><span class="o">(</span><span class="s1">'file://$MODULE_DIR$/src/[PATH TO SPRING BOOT APP]/[SPRING BOOT APP CLASS].java'</span><span class="o">){</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="n">facetManager</span><span class="o">.</span><span class="na">append</span> <span class="n">springFacet</span></code></pre></figure>

<p>Lastly, still using the node build object, I build another xml element for Infinitest.</p>

<figure class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="c1">// Setup Infinitest integration.</span>
<span class="kt">def</span> <span class="n">infinitestFacet</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">facet</span><span class="o">(</span><span class="nl">type:</span> <span class="s1">'Infinitest'</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'Infinitest'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">configuration</span> <span class="o">{</span> <span class="o">}</span>
<span class="o">}</span>
<span class="n">facetManager</span><span class="o">.</span><span class="na">append</span> <span class="n">infinitestFacet</span></code></pre></figure>

<p>Both of these produces the final output of:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;module</span> <span class="na">relativePaths=</span><span class="s">"true"</span> <span class="na">type=</span><span class="s">"JAVA_MODULE"</span> <span class="na">version=</span><span class="s">"4"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"FacetManager"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;facet</span> <span class="na">type=</span><span class="s">"Spring"</span> <span class="na">name=</span><span class="s">"Spring"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;fileset</span> <span class="na">id=</span><span class="s">"fileset"</span> <span class="na">name=</span><span class="s">"Spring Application Context"</span> <span class="na">removed=</span><span class="s">"false"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;file&gt;</span>file://$MODULE_DIR$/src/[PATH TO SPRING BOOT APP]/[SPRING BOOT APP CLASS].java<span class="nt">&lt;/file&gt;</span>
        <span class="nt">&lt;/fileset&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/facet&gt;</span>
    <span class="nt">&lt;facet</span> <span class="na">type=</span><span class="s">"Infinitest"</span> <span class="na">name=</span><span class="s">"Infinitest"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;configuration</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/facet&gt;</span>
  <span class="nt">&lt;/component&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/module&gt;</span></code></pre></figure>

<h4 id="so-how-do-you-add-your-own-plugin-configurations">So how do you add your own plugin configurations?</h4>

<p>I do the following steps:</p>

<ol>
  <li>Make a copy of your iml or ipr file.</li>
  <li>In Intellij, modify your settings to exactly what you want.</li>
  <li>Diff the two and determine what XML elements need to be created.</li>
  <li>Build the gradle configuration until you get exactly what you want.</li>
</ol>

<h2 id="lastly-is-it-worth-the-work">Lastly: <em>Is it worth the work?</em></h2>

<p>If it’s just you, maybe not.  I tend to work with teams of 3 - 15 developers.  A good chunk of them are really great developers and many of them can get stuck trying to get things setup.  Most developers are lazy <a href="http://c2.com/cgi/wiki?ProgrammingPerl">(which isn’t always thought of as a bad thing)</a> and so making things work “auto-magically” will result in the highest rate of adoption and the lowest rate of grumbling.</p>

<p>I am always open to hear your thoughts though…</p>

    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-12-22T00:00:00-05:00"><a href="/developer%20setup/Gradle-Intellij/">December 22, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Stephen Shary">Stephen Shary</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/developer%20setup/Gradle-Intellij/" rel="bookmark" title="Intellij and Gradle Setup and Integration" itemprop="url">Intellij and Gradle Setup and Integration</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>There are two main ways to setup your project in Intellij when using gradle as your build tool for a java project:</p>

<ul>
  <li>Import your gradle project using Intellij.</li>
  <li>Build your Intellij project using the Gradle idea plugin</li>
</ul>

<p>Here, I’ll discuss the three approaches and the pros and cons.  The end will talk about I do in the projects that I work on.</p>

<h2 id="import-your-gradle-project-using-intellij">Import your Gradle project Using Intellij</h2>

<p>Intellij has two big nice features:  “ability to import projects from the existing Gradle models. So doing, IntelliJ IDEA downloads all the necessary dependencies” and “ability to synchronize structures of Gradle and IntelliJ IDEA projects.”  In practice, this is where you open a project by selecting the “build.gradle” file in your project and the Intellij wizard(ry) does the rest.</p>

<p>Pros:</p>

<ul>
  <li>Very simple.</li>
  <li>Changes are synchronized.  As you change your <code class="highlighter-rouge">build.gradle</code> file, Intellij will automatically pull the dependency down and add it to your build path.  Make sure that you select the check box as seen below for this feature.</li>
</ul>

<p><img src="images/gradle-import.png" alt="Gradle import window in Intellij" class="center-image" /></p>

<p>Cons:</p>

<ul>
  <li>Intellij doesn’t import all of your settings.  Specifically, if there are plugin configurations for your project that you use with your <a href="https://docs.gradle.org/current/userguide/idea_plugin.html">idea plugin settings</a></li>
</ul>

<p><em>NOTE:</em>  JetBrains recommends that if you want to share your project settings on your team, that you should “.idea project configuration directory should be shared via version control.” <a href="https://www.jetbrains.com/idea/help/synchronizing-and-sharing-settings.html#d1421736e270">Source</a> <a href="https://intellij-support.jetbrains.com/hc/en-us/articles/206827587-How-to-manage-projects-under-Version-Control-Systems">and here</a> but it contains a number of “guidelines” of things that you should not include because they “contain keystore passwords”, “conflicts if another developer has the same name”.  I have also found when a project has these files checked in ( incorrectly albeit ), that every commit will inevitably contain some .iws change.</p>

<h2 id="build-your-intellij-project-using-the-gradle-idea-plugin">Build your Intellij project using the Gradle idea plugin</h2>

<p>Gradle has an <em>idea</em> plugin that allows you to build your Intellij project files.  You just need to include the line:</p>

<figure class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">'idea'</span></code></pre></figure>

<p>and when you run the command <code class="highlighter-rouge">gradlew idea</code> it will download your dependencies and setup your project.</p>

<p>Pros:</p>

<ul>
  <li>Very simple to setup dependencies.</li>
  <li>You can customize project settings including your Version Control, JDK Version, and other plugin settings.</li>
</ul>

<p>Cons:</p>

<ul>
  <li>Changes are not automatically synchronized.  You need to run <code class="highlighter-rouge">gradlew idea</code> to rebuild your dependencies.</li>
  <li>Making custom changes are not simple.  Most of them involve XML manipulation using groovy.</li>
</ul>

<h2 id="so-what-did-i-choose">So What Did I Choose?</h2>

<p>I chose to use the second option.  I found that even if the setup is harder, it’s worth it to automatically configure more parts of the development environment.  We have strong developers that spend the time to get their environment just right.  But, there are equally more people that will work with less optimal systems because they are unsure how to get it working.</p>

    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    Previous
  
  <ul class="inline-list">
    <li>
      
        <span class="current-page">1</span>
      
    </li>
    
  </ul>
  
    Next
  
</div><!-- /.pagination -->

</div><!-- /#main -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72001612-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>





<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 Stephen Shary. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
